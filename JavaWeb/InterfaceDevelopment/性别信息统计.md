# 性别信息统计
## 目录
- [请求信息](#请求信息)
- [实体类准备](#实体类准备)
- [SQL语句编写](#sql-语句编写)
- [逻辑实现](#逻辑实现)

---

### 请求信息
* **基本信息**
    * 请求路径：`/report/empGenderData`
    * 请求方式：`GET`
* **请求参数**
    * 无
* **响应数据**
    * 参数格式：`application/json`
    * 响应数据样例：

    <details>
    <summary>响应数据样例</summary>

    ```json
    {
        "code": 1,
        "msg": "操作成功",
        "data": {
            {"name": "男性员工", "value": 10},
            {"name": "女性员工", "value": 6}
        }
    }
    ```

    </details>

    * 参数说明：

| 参数名 | 类型 | 是否必须 | 备注 |
| --- | --- | --- | --- |
| code | number | 必须 | 响应码，1 代表成功，0 代表失败 |
| msg | string | 非必须 | 提示信息 |
| data | object | 非必须 | 返回的数据 |
| \|- name | string | 非必须 | 性别 |
| \|- value | number | 非必须 | 人数 |

---


### 实体类准备
* **分析**： 其中响应数据中就是类似于 List\<Map> 结构，所以我们直接封装到一个 List\<map> 集合中就可以了，无需创建一个实体类

---


### SQL 语句编写
- 统计员工性别人数
```sql
select 
    if(gender = 1, '男性员工', '女性员工') name,
    count(*) value
from emp group by gender;
```

---

### 逻辑实现
* **Controller 层**
    
    <details>
    <summary>代码</summary>

    ```java
    @Slf4j
    @RestController
    @RequestMapping("/report")
    public class ReportController {
        @Autowired
        private ReportService reportService;

        @GetMapping("/empGenderData")
        public Result getEmpGenderData() {
            log.info("统计员工性别人数");
            List<Map<String, Object>> genderList = reportService.getEmpGenderData();
            return Result.success(genderList);
        }
    }
    ```

    </details>

<br>

* **Service 层**

    <details>
    <summary>代码</summary>
    
    ```java
    public interface ReportService {
        List<Map<String, Object>> getEmpGenderData();
    }
    ```

    ```java
    @Service
    public class ReportServiceImpl implements ReportService {
        @Autowired
        private EmpMapper empMapper;

        @Override
        public List<Map<String, Object>> getEmpGenderData() {
            return empMapper.countEmpGenderData();
        }
    }
    ```
    
    </details>

<br>

* **Mapper 层**

    <details>
    <summary>代码</summary>
    
    ```java
    @Mapper
    public interface EmpMapper {
        /**
         * 根据员工性别统计人数
         * XML 文件映射
         */
        @MapKey("name")
        public List<Map<String, Object>> countEmpGenderData();
    }
    ```

    ```xml
    <mapper namespace="com.example.mapper.EmpMapper">
        <select id="countEmpGenderData" resultType="java.util.Map">
            select
                if(gender = 1, '男性员工', '女性员工') name,
                count(*) value
            from emp group by gender
        </select>
    </mapper>
    ```
    
    </details>