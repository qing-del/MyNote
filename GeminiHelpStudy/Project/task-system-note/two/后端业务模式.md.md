
### ğŸ“„ ç¬”è®° 4ï¼šåç«¯ä¸šåŠ¡æ¨¡å¼ (Backend Patterns)

**æ–‡ä»¶åå»ºè®®ï¼š** `Backend_Design_Patterns.md`
**è¯´æ˜ï¼š** æ€»ç»“ä½ åœ¨ Service å±‚å’Œ Mapper å±‚ç”¨åˆ°çš„æ ‡å‡†å†™æ³•ã€‚

# â˜• Java Spring Boot ä¸šåŠ¡æ¨¡å¼æ€»ç»“

## 1. åˆ†é¡µæŸ¥è¯¢æ¨¡å¼ (PageHelper)
ä¸æŸ¥è¯¢æ‰€æœ‰æ•°æ®ï¼Œè€Œæ˜¯æŒ‰éœ€åŠ è½½ï¼Œå‡è½»æ•°æ®åº“å‹åŠ›ã€‚

**å®ç°æ­¥éª¤**:
1. **Controller**: æ¥æ”¶ `pageNum`, `pageSize`ã€‚
2. **Service**: 
    - è°ƒç”¨ `PageHelper.startPage(pageNum, pageSize)` (å¿…é¡»åœ¨æŸ¥è¯¢å‰ä¸€è¡Œ)ã€‚
    - è°ƒç”¨ Mapper æŸ¥è¯¢è¿”å› `List`ã€‚
    - å¼ºåˆ¶è½¬æ¢ä¸º `Page<T>` è·å– `total` æ€»æ•°ã€‚
    - å°è£…ä¸º `PageResult` DTO è¿”å›ã€‚

## 2. åŠ¨æ€ SQL (MyBatis XML)
å¤„ç†å¤æ‚çš„æ¡ä»¶æŸ¥è¯¢ï¼ˆå¦‚ï¼šåªæŸ¥æŸäººçš„ä»»åŠ¡ï¼Œæˆ–è€…æŒ‰æ ‡é¢˜æœç´¢ï¼‰ã€‚

```xml
<select id="selectByTaskCondition" resultType="Task">
    select * from task
    <where>
        <if test="userId != null"> and user_id = #{userId} </if>
        <if test="status != null"> and status = #{status} </if>
        <if test="title != null"> and title like CONCAT('%', #{title}, '%') </if>
    </where>
    order by create_time desc
</select>
```

## 3. å…¨å±€å¼‚å¸¸å¤„ç† (Global Exception Handling)

ä¸å†åœ¨æ¯ä¸ª Controller é‡Œå†™ try-catchï¼Œè€Œæ˜¯ç»Ÿä¸€æ•è·ã€‚

- è‡ªå®šä¹‰å¼‚å¸¸: `TaskException`, `ItemException`ã€‚
    
- å¤„ç†å™¨: `@RestControllerAdvice` + `@ExceptionHandler`ã€‚
    
- æ•ˆæœ: å³ä½¿ Service æŠ›å‡ºå¼‚å¸¸ï¼Œå‰ç«¯æ”¶åˆ°çš„ä¹Ÿæ˜¯æ ¼å¼ç»Ÿä¸€çš„ 500/400 JSON å“åº”ã€‚
    

## 4. å•†åº—äº¤æ˜“äº‹åŠ¡ (ShopService)

å¤„ç†â€œé’±è´§ä¸¤æ¸…â€çš„é€»è¾‘ã€‚

**å…³é”®ç‚¹**:

- `@Transactional`: ç¡®ä¿åŸå­æ€§ã€‚
    
- **æ‰£è´¹æ£€æŸ¥**: `if (money < cost)` æå‰æ‹¦æˆªã€‚
    
- **Switch-Case**: å¤„ç†å¤šç§è´§å¸ç±»å‹ï¼ˆç»éªŒ/ç²¾ç¥/ä½“é­„/é‡‘å¸ï¼‰çš„é€šç”¨é€»è¾‘ã€‚