å¤ªæ£’äº†ï¼ä½ çš„å‰ç«¯å¼•æ“å·²ç»å¯åŠ¨ã€‚ğŸš€

ç°åœ¨æˆ‘ä»¬è¦æŠŠè¿™ä¸ªâ€œç©ºå£³â€å˜æˆä¸€ä¸ªèƒ½ç”¨çš„æ¸¸æˆå®¢æˆ·ç«¯ã€‚å› ä¸ºä½ ä¹‹å‰è¯´â€œå¿˜äº† Vue 3â€ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†é‡‡ç”¨**æœ€æ ‡å‡†ã€æœ€æ¨¡å—åŒ–**çš„å·¥ç¨‹å†™æ³•ã€‚è¿™æ ·å†™çš„å¥½å¤„æ˜¯ï¼šä»¥åä½ æƒ³åŠ ä»»ä½•åŠŸèƒ½ï¼ˆä»»åŠ¡åˆ—è¡¨ã€æ’è¡Œæ¦œï¼‰ï¼Œç…§çŒ«ç”»è™å°±è¡Œã€‚

æˆ‘ä»¬å°†åˆ†ä¸‰æ­¥å®Œæˆ **â€œç™»å½•åŠŸèƒ½â€** çš„é—­ç¯ï¼š

1. **åŸºç¡€è®¾æ–½**ï¼šé…ç½®å…¨å±€æ ·å¼ç»„ä»¶ (Element Plus) å’Œ è·¯ç”± (Router)ã€‚
    
2. **é€šè®¯ä¸­å¿ƒ**ï¼šå°è£… Axiosï¼ˆç½‘ç»œè¯·æ±‚ï¼‰ï¼Œè®©å®ƒè‡ªåŠ¨æºå¸¦ Tokenã€‚
    
3. **æ„å»ºé¡µé¢**ï¼šç¼–å†™ `Login.vue` å¹¶æµ‹è¯•ã€‚
    

---

### ğŸ§± Step 1: åŸºç¡€è®¾æ–½é…ç½® (main.js & router)

é¦–å…ˆï¼Œæˆ‘ä»¬è¦å‘Šè¯‰ Vueï¼šâ€œæˆ‘ä»¬è¦ç”¨ Element Plus ç»„ä»¶åº“ï¼Œä¸”æˆ‘ä»¬è¦ç”¨è·¯ç”±æ¥åˆ‡æ¢é¡µé¢â€ã€‚

#### 1.1 åˆå§‹åŒ–è·¯ç”±

è¯·åœ¨ `src` ç›®å½•ä¸‹æ–°å»ºæ–‡ä»¶å¤¹ `router`ï¼Œå¹¶åœ¨é‡Œé¢æ–°å»º `index.js`ï¼š

```JavaScript
// src/router/index.js
import { createRouter, createWebHistory } from 'vue-router'

const routes = [
    {
        path: '/login',
        name: 'Login',
        component: () => import('../views/Login.vue') // æ‡’åŠ è½½ï¼Œå¾…ä¼šæˆ‘ä»¬å»å†™è¿™ä¸ªæ–‡ä»¶
    },
    {
        path: '/',
        name: 'Game',
        component: () => import('../views/Game.vue') // æ¸¸æˆä¸»ç•Œé¢ï¼Œç¨åå†™
    }
]

const router = createRouter({
    history: createWebHistory(),
    routes
})

export default router
```

#### 1.2 å…¨å±€å…¥å£é…ç½®

ä¿®æ”¹ `src/main.js`ï¼ŒæŠŠ Element Plus å’Œ è·¯ç”± æŒ‚è½½ä¸Šå»ã€‚

```JavaScript
// src/main.js
import { createApp } from 'vue'
import App from './App.vue'

// 1. å¼•å…¥ Element Plus åŠå…¶æ ·å¼
import ElementPlus from 'element-plus'
import 'element-plus/dist/index.css'

// 2. å¼•å…¥è·¯ç”±
import router from './router'

const app = createApp(App)

// 3. ä½¿ç”¨æ’ä»¶
app.use(ElementPlus)
app.use(router)

app.mount('#app')
```

#### 1.3 ä¿®æ”¹ App.vue

ä¿®æ”¹ `src/App.vue`ï¼Œè®©å®ƒå˜æˆä¸€ä¸ªâ€œçª—å£â€ï¼Œæ ¹æ®è·¯ç”±å±•ç¤ºä¸åŒçš„é¡µé¢ã€‚

```HTML
<script setup>
</script>

<template>
  <router-view></router-view>
</template>

<style>
body { margin: 0; background-color: #f0f2f5; font-family: 'Helvetica Neue', Helvetica, 'PingFang SC', sans-serif; }
</style>
```

---

### ğŸ“¡ Step 2: å°è£…ç½‘ç»œè¯·æ±‚ (request.js)

è¿™æ˜¯å…¨æ ˆå¼€å‘ä¸­æœ€é‡è¦çš„ä¸€æ­¥ï¼

è¿˜è®°å¾—ä½ åœ¨ HTML é‡Œå†™çš„ fetch å’Œæ‰‹åŠ¨åŠ  Authorization å¤´å—ï¼Ÿå¤ªéº»çƒ¦äº†ã€‚æˆ‘ä»¬é…ç½®ä¸€ä¸ª Axios æ‹¦æˆªå™¨ï¼Œè®©å®ƒè‡ªåŠ¨ä»æµè§ˆå™¨ç¼“å­˜é‡Œæ‰¾ Token å¹¶å¸¦ä¸Šã€‚

è¯·åœ¨ `src` ä¸‹æ–°å»ºæ–‡ä»¶å¤¹ `utils`ï¼Œå¹¶æ–°å»º `request.js`ï¼š

```JavaScript
// src/utils/request.js
import axios from 'axios'
import { ElMessage } from 'element-plus' // æ¼‚äº®çš„å¼¹çª—æç¤º

// 1. åˆ›å»º Axios å®ä¾‹
const request = axios.create({
    baseURL: 'http://localhost:8080', // ä½ çš„ Spring Boot åç«¯åœ°å€
    timeout: 5000
})

// 2. è¯·æ±‚æ‹¦æˆªå™¨ï¼šè‡ªåŠ¨æˆ´ä¸Šâ€œå·¥ç‰Œâ€ (Token)
request.interceptors.request.use(config => {
    // ä» LocalStorage è·å– Token
    const token = localStorage.getItem('token')
    if (token) {
        config.headers['Authorization'] = `Bearer ${token}`
    }
    return config
}, error => {
    return Promise.reject(error)
})

// 3. å“åº”æ‹¦æˆªå™¨ï¼šç»Ÿä¸€å¤„ç†æŠ¥é”™
request.interceptors.response.use(
    response => {
        return response.data // åªè¿”å›åç«¯çš„æ•°æ®éƒ¨åˆ†ï¼Œä¸¢æ‰ axios çš„å£³
    },
    error => {
        // å¦‚æœåç«¯è¿”å› 403/401ï¼Œè¯´æ˜ Token è¿‡æœŸæˆ–ä¸å¯¹
        if (error.response && (error.response.status === 403 || error.response.status === 401)) {
            ElMessage.error('ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•')
            localStorage.removeItem('token')
            // è¿™é‡Œå¯ä»¥åŠ è·³è½¬å›ç™»å½•é¡µçš„é€»è¾‘
        } else {
            ElMessage.error(error.message || 'ç½‘ç»œå¼‚å¸¸')
        }
        return Promise.reject(error)
    }
)

export default request
```

---

### ğŸ” Step 3: ç¼–å†™ç™»å½•é¡µ (Login.vue)

æœ€åï¼Œæˆ‘ä»¬æ¥ç”»é¡µé¢ã€‚è¯·åœ¨ `src` ä¸‹æ–°å»ºæ–‡ä»¶å¤¹ `views`ï¼Œå¹¶æ–°å»º `Login.vue`ã€‚

è¿™é‡Œçš„ `<script setup>` é€»è¾‘éå¸¸æ¸…æ™°ï¼š

1. å®šä¹‰è¡¨å•æ•°æ® `form`ã€‚
    
2. ç‚¹å‡»ç™»å½• -> å‘é€ Post è¯·æ±‚ã€‚
    
3. æ‹¿åˆ° Token -> å­˜å…¥ LocalStorageã€‚
    
4. è·³è½¬åˆ°æ¸¸æˆé¡µã€‚
    

```HTML
<template>
  <div class="login-container">
    <el-card class="login-card">
      <template #header>
        <div class="card-header">
          <h2>ğŸš€ LifeGame å¯åŠ¨</h2>
        </div>
      </template>
      
      <el-form :model="form" label-width="0px">
        <el-form-item>
          <el-input v-model="form.username" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" size="large" />
        </el-form-item>
        <el-form-item>
          <el-input v-model="form.password" type="password" placeholder="è¯·è¾“å…¥å¯†ç " size="large" show-password />
        </el-form-item>
        <el-form-item>
          <el-button type="primary" class="btn-full" @click="handleLogin" :loading="loading" size="large">ç™» å½•</el-button>
        </el-form-item>
        <el-form-item>
           <el-button class="btn-full" @click="handleRegister" size="large">æ³¨ å†Œ æ–° è´¦ å·</el-button>
        </el-form-item>
      </el-form>
    </el-card>
  </div>
</template>

<script setup>
import { ref, reactive } from 'vue'
import request from '../utils/request' // å¼•å…¥æˆ‘ä»¬åˆšæ‰å†™çš„è¯·æ±‚å·¥å…·
import { useRouter } from 'vue-router'
import { ElMessage } from 'element-plus'

const router = useRouter()
const loading = ref(false)

// å“åº”å¼è¡¨å•æ•°æ®
const form = reactive({
  username: '',
  password: ''
})

// ç™»å½•é€»è¾‘
const handleLogin = async () => {
  if(!form.username || !form.password) {
    ElMessage.warning('è¯·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ')
    return
  }

  loading.value = true
  try {
    // å‘é€è¯·æ±‚ç»™åç«¯ /api/auth/login
    const res = await request.post('/api/auth/login', form)
    
    // å¦‚æœ Axios æ²¡æŠ¥é”™ï¼Œè¯´æ˜æˆåŠŸäº† (æ‹¦æˆªå™¨å·²ç»è¿‡æ»¤äº† data)
    // 1. å­˜ Token
    localStorage.setItem('token', res.token)
    ElMessage.success('ç™»å½•æˆåŠŸï¼Œæ­£åœ¨è¿›å…¥ç³»ç»Ÿ...')
    
    // 2. è·³è½¬åˆ°æ¸¸æˆä¸»é¡µ (ç¨ååˆ›å»º)
    router.push('/')
    
  } catch (error) {
    console.error(error) // æ‹¦æˆªå™¨å·²å¼¹å‡ºé”™è¯¯æç¤º
  } finally {
    loading.value = false
  }
}

// æ³¨å†Œé€»è¾‘ (ç®€å•å¤ç”¨ç™»å½•æ¥å£é€»è¾‘ï¼Œä½ éœ€è¦ç¡®ä¿åç«¯æ³¨å†Œæ¥å£è·¯å¾„æ­£ç¡®)
const handleRegister = async () => {
    if(!form.username || !form.password) return ElMessage.warning('è¯·è¾“å…¥è´¦å·å¯†ç ')
    try {
        const res = await request.post('/api/auth/register', form)
        // åç«¯è¿”å› String "æ³¨å†ŒæˆåŠŸ" æˆ–å…¶ä»–
        ElMessage.success('æ³¨å†ŒæˆåŠŸï¼Œè¯·ç‚¹å‡»ç™»å½•')
    } catch (e) {
        // é”™è¯¯å¤„ç†
    }
}
</script>

<style scoped>
.login-container {
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: linear-gradient(135deg, #1f1c2c, #928dab);
}
.login-card {
  width: 400px;
  border-radius: 10px;
}
.card-header {
  text-align: center;
}
.btn-full {
  width: 100%;
}
</style>
```

#### è¡¥å……ï¼šä¸´æ—¶çš„ Game.vue

ä¸ºäº†é˜²æ­¢è·³è½¬æŠ¥é”™ï¼Œè¯·åœ¨ `views` ä¸‹å¿«é€Ÿå»ºä¸€ä¸ª `Game.vue`ï¼š

```HTML
<template><h1>ğŸ® æ¸¸æˆä¸»ç•Œé¢ (å¼€å‘ä¸­...)</h1></template>
```

---

### ğŸ§ª è¯•è¿è¡Œï¼

1. ç¡®ä¿åç«¯ (Spring Boot) æ­£åœ¨è¿è¡Œã€‚
    
2. ç¡®ä¿å‰ç«¯ (Vite) æ­£åœ¨è¿è¡Œ (`npm run dev`)ã€‚
    
3. æ‰“å¼€æµè§ˆå™¨è®¿é—®å‰ç«¯åœ°å€ (å¦‚ `http://localhost:5173/login`)ã€‚
    
    - _æ³¨ï¼šå› ä¸ºæˆ‘ä»¬é…ç½®äº†è·¯ç”±ï¼Œå¦‚æœç›´æ¥è®¿é—® `/` å¯èƒ½ä¼šå› ä¸ºè¿˜æ²¡åšè·¯ç”±å®ˆå«ï¼ˆGuardï¼‰è€Œè·³åˆ° Game é¡µï¼Œæ‰€ä»¥å…ˆæ‰‹åŠ¨è¾“å…¥ `/login` æˆ–è€…åœ¨ä»£ç é‡Œåšé‡å®šå‘ï¼Œä½†æš‚æ—¶æ‰‹åŠ¨è¾“ä¸€ä¸‹å§ã€‚_
        

**å°è¯•æ“ä½œï¼š**

1. è¾“å…¥ä¹‹å‰çš„è´¦å·å¯†ç ã€‚
    
2. ç‚¹å‡»ç™»å½•ã€‚
    
3. è§‚å¯Ÿæ˜¯å¦å¼¹å‡ºäº†ç»¿è‰²çš„â€œç™»å½•æˆåŠŸâ€ï¼Œå¹¶ä¸”è·³è½¬åˆ°äº†â€œæ¸¸æˆä¸»ç•Œé¢â€ã€‚
    

**å¦‚æœè¿™ä¸€æ­¥æˆåŠŸäº†ï¼Œä½ å°±æ˜¯ä¸€ååˆæ ¼çš„å…¨æ ˆå¼€å‘äº†ï¼** è¯·å‘Šè¯‰æˆ‘ç»“æœã€‚