è¿™å®Œå…¨ç¬¦åˆé¢„æœŸï¼ä½œä¸ºå¯¼å¸ˆï¼Œæˆ‘æ¥å¸®ä½ åƒä¾¦æ¢ä¸€æ ·åˆ†æä¸€ä¸‹è¿™ä¸¤ä¸ªç°è±¡ï¼Œç„¶åæˆ‘ä»¬ç«‹åˆ»å†™å‡ºé‚£ä¸ªé…·ç‚«çš„å±æ€§é¢æ¿ã€‚

### ğŸ•µï¸â€â™‚ï¸ æ¡ˆæƒ…åˆ†æ

**ç°è±¡ 1ï¼šè¾“é”™å¯†ç æ˜¾ç¤ºâ€œç™»å½•å·²è¿‡æœŸâ€**

- **åŸå› **ï¼šè¿™æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨ `request.js` é‡Œå†™äº†ä¸€ä¸ªâ€œå…¨å±€æ‹¦æˆªå™¨â€ã€‚å½“åç«¯è¿”å› `403 Forbidden`ï¼ˆå¯†ç é”™è¯¯ï¼‰æ—¶ï¼Œæ‹¦æˆªå™¨ä¸åˆ†é’çº¢çš‚ç™½ï¼Œä»¥ä¸ºæ˜¯ Token è¿‡æœŸäº†ï¼Œæ‰€ä»¥å¼¹å‡ºäº†é‚£ä¸ªé€šç”¨æç¤ºã€‚
    
- **è§£å†³**ï¼šæˆ‘ä»¬éœ€è¦å‘Šè¯‰æ‹¦æˆªå™¨ï¼šâ€œå¦‚æœæ˜¯**ç™»å½•æ¥å£**æŠ¥é”™ï¼Œå°±åˆ«ç®¡é—²äº‹ï¼Œç›´æ¥æŠŠé”™è¯¯æŠ›å›å»ç»™ Login é¡µé¢å¤„ç†ã€‚â€
    

**ç°è±¡ 2ï¼šè¾“å¯¹å¯†ç æ²¡ååº”**

- **åŸå› **ï¼šå…¶å®ååº”å‘ç”Ÿäº†ï¼ç™»å½•æˆåŠŸ -> æ‹¿åˆ° Token -> å­˜å…¥ LocalStorage -> è·³è½¬åˆ°äº† `/` (Game é¡µé¢)ã€‚
    
- **çœŸç›¸**ï¼šä½†æ˜¯ï¼å› ä¸ºä½ ä¹‹å‰çš„ `Game.vue` é‡Œé¢åªæœ‰ä¸€è¡Œ `<h1>`ï¼ˆæˆ–è€…å¯èƒ½æ˜¯ç©ºçš„ï¼‰ï¼Œè€Œä¸”èƒŒæ™¯å¯èƒ½ä¹Ÿæ˜¯ç™½çš„ï¼Œæ‰€ä»¥çœ‹èµ·æ¥åƒâ€œå¡ä½â€äº†ä¸€æ ·ã€‚
    
- **è§£å†³**ï¼šæˆ‘ä»¬éœ€è¦å¡«å…… `Game.vue`ï¼Œè®©å®ƒä¸€åŠ è½½å°±å»åç«¯æ‹‰å–ç©å®¶æ•°æ®å¹¶æ˜¾ç¤ºå‡ºæ¥ã€‚
    

---

### ğŸ› ï¸ ä¿®å¤æ­¥éª¤ 1ï¼šä¼˜åŒ–æ‹¦æˆªå™¨ (request.js)

è¯·æ‰“å¼€ `src/utils/request.js`ï¼Œæˆ‘ä»¬éœ€è¦ç»™æ‹¦æˆªå™¨åŠ ä¸€ä¸ªâ€œç‰¹ä¾‹â€ï¼Œæ”¾è¿‡ç™»å½•æ¥å£çš„æŠ¥é”™ã€‚

æ‰¾åˆ°å“åº”æ‹¦æˆªå™¨éƒ¨åˆ† (`request.interceptors.response.use`)ï¼Œä¿®æ”¹ `error` çš„å¤„ç†é€»è¾‘ï¼š


```JavaScript
// src/utils/request.js (ä¿®æ”¹å“åº”æ‹¦æˆªå™¨éƒ¨åˆ†)

request.interceptors.request.use(config => {
    // ... ä¿æŒä¸å˜ ...
    const token = localStorage.getItem('token')
    if (token) {
        config.headers['Authorization'] = `Bearer ${token}`
    }
    return config
}, error => {
    return Promise.reject(error)
})

request.interceptors.response.use(
    response => {
        return response.data
    },
    error => {
        // ğŸ”¥ ä¿®å¤ç‚¹ï¼šå¦‚æœæ˜¯ç™»å½•æ¥å£æŠ¥é”™ (403)ï¼Œä¸è¦å¼¹å‡ºâ€œç™»å½•è¿‡æœŸâ€ï¼Œç›´æ¥è·³è¿‡
        if (error.config.url.includes('/login')) {
            return Promise.reject(error)
        }

        // å…¶ä»–æ¥å£å¦‚æœæŠ¥ 403/401ï¼Œæ‰æ˜¯çœŸçš„è¿‡æœŸ
        if (error.response && (error.response.status === 403 || error.response.status === 401)) {
            ElMessage.error('ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•')
            localStorage.removeItem('token')
            // window.location.href = '/login' // å¯é€‰ï¼šå¼ºåˆ¶åˆ·æ–°å›ç™»å½•é¡µ
        } else {
            ElMessage.error(error.message || 'ç½‘ç»œå¼‚å¸¸')
        }
        return Promise.reject(error)
    }
)

export default request
```

---

### ğŸ® ä¿®å¤æ­¥éª¤ 2ï¼šæ‰“é€ ç©å®¶é¢æ¿ (Game.vue)

è¿™æ˜¯ä»Šå¤©çš„é‡å¤´æˆï¼æˆ‘ä»¬å°†ä½¿ç”¨ Vue 3 çš„ `onMounted` ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œåœ¨é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¯·æ±‚åç«¯ `/task/status` æ¥å£ã€‚

è¯·æŠŠ `src/views/Game.vue` çš„å†…å®¹å…¨éƒ¨æ›¿æ¢ä¸ºä»¥ä¸‹ä»£ç ï¼š

```HTML
<template>
  <div class="game-container">
    
    <div class="header">
      <h2 class="title">âš”ï¸ LifeGame ç³»ç»Ÿ</h2>
      <el-button type="danger" size="small" @click="handleLogout">é€€å‡ºç™»å½•</el-button>
    </div>

    <div class="content">
      
      <el-card class="status-card" v-loading="loading">
        <template #header>
          <div class="card-header">
            <span>ğŸ§™â€â™‚ï¸ ç©å®¶çŠ¶æ€</span>
            <el-tag type="success">Lv.{{ player.level }}</el-tag>
          </div>
        </template>
        
        <div class="stats-grid">
          <div class="stat-item">
            <div class="label">ç²¾ç¥ (Spirit)</div>
            <div class="value spirit">{{ player.spirit }}</div>
          </div>
          
          <div class="stat-item">
            <div class="label">ä½“é­„ (Body)</div>
            <div class="value body">{{ player.body }}</div>
          </div>
        </div>

        <div class="exp-section">
          <div class="exp-label">
            <span>ç»éªŒå€¼ (EXP)</span>
            <span>{{ player.currentExp }} / {{ player.nextLevelExp || 100 }}</span>
          </div>
          <el-progress 
            :text-inside="true" 
            :stroke-width="20" 
            :percentage="calculateExpPercent()" 
            status="exception"
            color="#f56c6c"
          />
        </div>
      </el-card>

      <el-card class="action-card">
        <template #header>
          <span>ğŸ“œ å½“å‰ä»»åŠ¡</span>
        </template>
        <el-empty description="æš‚æ— è¿›è¡Œä¸­çš„ä»»åŠ¡ï¼Œè¯·ç‚¹å‡»ç”Ÿæˆ" />
        <div style="text-align: center; margin-top: 20px;">
             <el-button type="primary" size="large" circle>âš¡</el-button>
             <p>å‘¼å« AI ç”Ÿæˆä»»åŠ¡</p>
        </div>
      </el-card>

    </div>
  </div>
</template>

<script setup>
import { ref, onMounted, reactive } from 'vue'
import request from '../utils/request'
import { useRouter } from 'vue-router'
import { ElMessage } from 'element-plus'

const router = useRouter()
const loading = ref(true)

// ç©å®¶åˆå§‹æ•°æ®
const player = reactive({
  id: null,
  level: 1,
  spirit: 0,
  body: 0,
  currentExp: 0,
  nextLevelExp: 100 // å‡è®¾æ¯çº§100ç»éªŒï¼Œä½ å¯ä»¥æ ¹æ®åç«¯é€»è¾‘è°ƒæ•´
})

// ğŸ”„ é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ
onMounted(async () => {
  await fetchPlayerStatus()
})

// è·å–æ•°æ®å‡½æ•°
const fetchPlayerStatus = async () => {
  try {
    // è¿™é‡Œçš„ get è¯·æ±‚ä¼šè‡ªåŠ¨å¸¦ä¸Š request.js é‡Œçš„ Token
    // åç«¯ Controller å·²ç»æ”¹æˆäº†ä» Token è¯» IDï¼Œæ‰€ä»¥ä¸éœ€è¦ä¼ å‚
    const res = await request.get('/task/status')
    
    // å¦‚æœæ‹¿åˆ°æ•°æ®ï¼Œæ›´æ–°é¡µé¢æ˜¾ç¤º
    if (res) {
      Object.assign(player, res)
      // ç®€å•çš„å‡çº§ç»éªŒå…¬å¼æ¼”ç¤ºï¼šç­‰çº§ * 100 (ä½ éœ€è¦æ ¹æ®åç«¯é€»è¾‘ä¿®æ”¹)
      player.nextLevelExp = player.level * 100 
    }
  } catch (error) {
    console.error('è·å–çŠ¶æ€å¤±è´¥', error)
  } finally {
    loading.value = false
  }
}

// è®¡ç®—ç»éªŒç™¾åˆ†æ¯”
const calculateExpPercent = () => {
  if (player.nextLevelExp === 0) return 0
  let pct = (player.currentExp / player.nextLevelExp) * 100
  return pct > 100 ? 100 : parseInt(pct)
}

// é€€å‡ºç™»å½•
const handleLogout = () => {
  localStorage.removeItem('token')
  router.push('/login')
  ElMessage.success('å·²å®‰å…¨é€€å‡º')
}
</script>

<style scoped>
.game-container {
  min-height: 100vh;
  background-color: #1a1a1a;
  color: #e0e0e0;
  padding: 20px;
}

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 10px;
  border-bottom: 1px solid #333;
}

.title { color: #409eff; margin: 0; }

.content {
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
}

.status-card, .action-card {
  width: 400px;
  background-color: #2b2b2b;
  border: 1px solid #444;
  color: white;
}
/* è¦†ç›– Element Plus å¡ç‰‡é»˜è®¤èƒŒæ™¯ */
:deep(.el-card) {
    background-color: #2b2b2b;
    border-color: #444;
    color: white;
}
:deep(.el-card__header) {
    border-bottom-color: #444;
}

.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-weight: bold;
}

.stats-grid {
  display: flex;
  justify-content: space-around;
  margin-bottom: 20px;
}

.stat-item {
  text-align: center;
}

.stat-item .label {
  font-size: 12px;
  color: #888;
  margin-bottom: 5px;
}

.stat-item .value {
  font-size: 24px;
  font-weight: bold;
}

.spirit { color: #b39ddb; text-shadow: 0 0 10px rgba(179, 157, 219, 0.5); }
.body { color: #ef9a9a; text-shadow: 0 0 10px rgba(239, 154, 154, 0.5); }

.exp-section {
  margin-top: 10px;
}
.exp-label {
  display: flex;
  justify-content: space-between;
  font-size: 12px;
  color: #aaa;
  margin-bottom: 5px;
}
</style>
```

---

### ğŸ§ª å†æ¬¡æµ‹è¯• (Action)

1. ä¿å­˜è¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚
    
2. å›åˆ°æµè§ˆå™¨ï¼Œåˆ·æ–°é¡µé¢ã€‚
    
3. **æµ‹è¯•é”™è¯¯æƒ…å†µ**ï¼šæ•…æ„è¾“é”™å¯†ç ï¼Œçœ‹çœ‹æ˜¯å¦å¼¹å‡ºçº¢è‰²çš„ Element Plus é”™è¯¯æç¤ºï¼ˆè€Œä¸æ˜¯â€œç™»å½•è¿‡æœŸâ€ï¼‰ã€‚
    
4. **æµ‹è¯•æ­£ç¡®æƒ…å†µ**ï¼šè¾“å…¥æ­£ç¡®å¯†ç ï¼Œç‚¹å‡»ç™»å½•ã€‚
    

é¢„æœŸç»“æœï¼š

ä½ åº”è¯¥ä¼šç¬é—´è·³è½¬åˆ°ä¸€ä¸ª æ·±è‰²æ¨¡å¼çš„æ§åˆ¶å°ç•Œé¢ï¼Œä¸­é—´çš„å¡ç‰‡ä¼šæ˜¾ç¤ºï¼š

- Lv.1
    
- ç²¾ç¥: 1
    
- ä½“é­„: 1
    
- ç»éªŒæ¡å¯èƒ½æ˜¯ç©ºçš„ (0/100)ã€‚
    

**å¦‚æœçœ‹åˆ°è¿™ä¸ªç”»é¢ï¼Œè¯·å¤§å£°å›å¤æˆ‘ï¼šâ€œDashboard Online!â€** è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è¿›å…¥æ›´æœ‰è¶£çš„ç¯èŠ‚ï¼š**è®© AI çœŸçš„ç”Ÿæˆä»»åŠ¡ï¼**